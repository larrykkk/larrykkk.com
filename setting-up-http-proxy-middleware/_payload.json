[{"data":1,"prerenderedAt":194},["ShallowReactive",2],{"$PO0ZRGd7KQ":3},{"id":4,"title":5,"body":6,"description":12,"extension":174,"meta":175,"navigation":51,"path":190,"seo":191,"stem":192,"__hash__":193},"content/設定 http-proxy-middleware.md","設定 Http Proxy Middleware",{"type":7,"value":8,"toc":169},"minimal",[9,13,21,24,28,104,107,133,137,140,143,146,149,152,155,159,165],[10,11,12],"p",{},"今天同事問我他遇到前端設定 API proxy 搞不定，於是我只好翻出好久以前自己做的紀錄來處理。",[10,14,15],{},[16,17,18],"a",{"href":18,"rel":19},"https://www.youtube.com/?gl=TW&tab=w1",[20],"nofollow",[10,22,23],{},"...",[25,26,27],"h2",{"id":27},"先貼一下標準範例",[29,30,35],"pre",{"className":31,"code":32,"language":33,"meta":34,"style":34},"language-javascript shiki shiki-themes github-light github-dark","// javascript\n\nconst express = require('express');\nconst { createProxyMiddleware } = require('http-proxy-middleware');\n\nconst app = express();\n\napp.use('/api', createProxyMiddleware({ target: 'http://www.example.org', changeOrigin: true }));\napp.listen(3000);\n\n// http://localhost:3000/api/foo/bar -> http://www.example.org/api/foo/bar\n","javascript","",[36,37,38,46,53,59,65,70,76,81,87,93,98],"code",{"__ignoreMap":34},[39,40,43],"span",{"class":41,"line":42},"line",1,[39,44,45],{},"// javascript\n",[39,47,49],{"class":41,"line":48},2,[39,50,52],{"emptyLinePlaceholder":51},true,"\n",[39,54,56],{"class":41,"line":55},3,[39,57,58],{},"const express = require('express');\n",[39,60,62],{"class":41,"line":61},4,[39,63,64],{},"const { createProxyMiddleware } = require('http-proxy-middleware');\n",[39,66,68],{"class":41,"line":67},5,[39,69,52],{"emptyLinePlaceholder":51},[39,71,73],{"class":41,"line":72},6,[39,74,75],{},"const app = express();\n",[39,77,79],{"class":41,"line":78},7,[39,80,52],{"emptyLinePlaceholder":51},[39,82,84],{"class":41,"line":83},8,[39,85,86],{},"app.use('/api', createProxyMiddleware({ target: 'http://www.example.org', changeOrigin: true }));\n",[39,88,90],{"class":41,"line":89},9,[39,91,92],{},"app.listen(3000);\n",[39,94,96],{"class":41,"line":95},10,[39,97,52],{"emptyLinePlaceholder":51},[39,99,101],{"class":41,"line":100},11,[39,102,103],{},"// http://localhost:3000/api/foo/bar -> http://www.example.org/api/foo/bar\n",[10,105,106],{},"從上面的程式碼可以歸納出以下步驟:",[108,109,110,114,120,130],"ol",{},[111,112,113],"li",{},"首先你需要起一個 node server (範例中使用 Express.js)",[111,115,116,117],{},"從 http-proxy-middleware 解構出 ",[36,118,119],{},"createProxyMiddleware",[111,121,122,123,126,127,129],{},"對你要轉換的路由 (範例中藥轉換的路徑是 ",[36,124,125],{},"/api",")，將 ",[36,128,119],{}," 帶入一些選項之後套用到 Express 的路由上",[111,131,132],{},"對外持續監聽某一個 port，等待轉發",[25,134,136],{"id":135},"http-proxy-middleware-幾個常見的選項","http-proxy-middleware 幾個常見的選項",[10,138,139],{},"target:",[10,141,142],{},"目標 host",[10,144,145],{},"changeOrigin:",[10,147,148],{},"需不需要轉來源(通常用在要跨域的情況下，所以給 true)",[10,150,151],{},"pathRewrite:",[10,153,154],{},"改寫路徑，如下的寫法，會將你 /old-path 的 request 都轉給 /new-path\n'^/api/old-path': '/api/new-path'",[25,156,158],{"id":157},"參考","參考:",[10,160,161],{},[16,162,163],{"href":163,"rel":164},"https://www.npmjs.com/package/http-proxy-middleware#http-proxy-middleware-options",[20],[166,167,168],"style",{},"html .default .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}html .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}html .dark .shiki span {color: var(--shiki-dark);background: var(--shiki-dark-bg);font-style: var(--shiki-dark-font-style);font-weight: var(--shiki-dark-font-weight);text-decoration: var(--shiki-dark-text-decoration);}html.dark .shiki span {color: var(--shiki-dark);background: var(--shiki-dark-bg);font-style: var(--shiki-dark-font-style);font-weight: var(--shiki-dark-font-weight);text-decoration: var(--shiki-dark-text-decoration);}",{"title":34,"searchDepth":48,"depth":48,"links":170},[171,172,173],{"id":27,"depth":48,"text":27},{"id":135,"depth":48,"text":136},{"id":157,"depth":48,"text":158},"md",{"createdAt":176,"url":177,"tags":178,"excerpt":181},"2020-11-11 17:13:12","setting-up-http-proxy-middleware",[179,180],"前端","筆記",{"type":7,"value":182},[183,185],[10,184,12],{},[10,186,187],{},[16,188,18],{"href":18,"rel":189},[20],"/http-proxy-middleware",{"title":5,"description":12},"設定 http-proxy-middleware","bRYec5bove-9FfeAwnN4CC3NCFldoKFM93tGMn-LUKo",1744039164534]