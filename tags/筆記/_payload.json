[{"data":1,"prerenderedAt":195},["ShallowReactive",2],{"tag-筆記":3},[4],{"id":5,"title":6,"body":7,"description":13,"extension":175,"meta":176,"navigation":52,"path":191,"seo":192,"stem":193,"__hash__":194},"content/設定 http-proxy-middleware.md","設定 Http Proxy Middleware",{"type":8,"value":9,"toc":170},"minimal",[10,14,22,25,29,105,108,134,138,141,144,147,150,153,156,160,166],[11,12,13],"p",{},"今天同事問我他遇到前端設定 API proxy 搞不定，於是我只好翻出好久以前自己做的紀錄來處理。",[11,15,16],{},[17,18,19],"a",{"href":19,"rel":20},"https://www.youtube.com/?gl=TW&tab=w1",[21],"nofollow",[11,23,24],{},"...",[26,27,28],"h2",{"id":28},"先貼一下標準範例",[30,31,36],"pre",{"className":32,"code":33,"language":34,"meta":35,"style":35},"language-javascript shiki shiki-themes github-light github-dark","// javascript\n\nconst express = require('express');\nconst { createProxyMiddleware } = require('http-proxy-middleware');\n\nconst app = express();\n\napp.use('/api', createProxyMiddleware({ target: 'http://www.example.org', changeOrigin: true }));\napp.listen(3000);\n\n// http://localhost:3000/api/foo/bar -> http://www.example.org/api/foo/bar\n","javascript","",[37,38,39,47,54,60,66,71,77,82,88,94,99],"code",{"__ignoreMap":35},[40,41,44],"span",{"class":42,"line":43},"line",1,[40,45,46],{},"// javascript\n",[40,48,50],{"class":42,"line":49},2,[40,51,53],{"emptyLinePlaceholder":52},true,"\n",[40,55,57],{"class":42,"line":56},3,[40,58,59],{},"const express = require('express');\n",[40,61,63],{"class":42,"line":62},4,[40,64,65],{},"const { createProxyMiddleware } = require('http-proxy-middleware');\n",[40,67,69],{"class":42,"line":68},5,[40,70,53],{"emptyLinePlaceholder":52},[40,72,74],{"class":42,"line":73},6,[40,75,76],{},"const app = express();\n",[40,78,80],{"class":42,"line":79},7,[40,81,53],{"emptyLinePlaceholder":52},[40,83,85],{"class":42,"line":84},8,[40,86,87],{},"app.use('/api', createProxyMiddleware({ target: 'http://www.example.org', changeOrigin: true }));\n",[40,89,91],{"class":42,"line":90},9,[40,92,93],{},"app.listen(3000);\n",[40,95,97],{"class":42,"line":96},10,[40,98,53],{"emptyLinePlaceholder":52},[40,100,102],{"class":42,"line":101},11,[40,103,104],{},"// http://localhost:3000/api/foo/bar -> http://www.example.org/api/foo/bar\n",[11,106,107],{},"從上面的程式碼可以歸納出以下步驟:",[109,110,111,115,121,131],"ol",{},[112,113,114],"li",{},"首先你需要起一個 node server (範例中使用 Express.js)",[112,116,117,118],{},"從 http-proxy-middleware 解構出 ",[37,119,120],{},"createProxyMiddleware",[112,122,123,124,127,128,130],{},"對你要轉換的路由 (範例中藥轉換的路徑是 ",[37,125,126],{},"/api",")，將 ",[37,129,120],{}," 帶入一些選項之後套用到 Express 的路由上",[112,132,133],{},"對外持續監聽某一個 port，等待轉發",[26,135,137],{"id":136},"http-proxy-middleware-幾個常見的選項","http-proxy-middleware 幾個常見的選項",[11,139,140],{},"target:",[11,142,143],{},"目標 host",[11,145,146],{},"changeOrigin:",[11,148,149],{},"需不需要轉來源(通常用在要跨域的情況下，所以給 true)",[11,151,152],{},"pathRewrite:",[11,154,155],{},"改寫路徑，如下的寫法，會將你 /old-path 的 request 都轉給 /new-path\n'^/api/old-path': '/api/new-path'",[26,157,159],{"id":158},"參考","參考:",[11,161,162],{},[17,163,164],{"href":164,"rel":165},"https://www.npmjs.com/package/http-proxy-middleware#http-proxy-middleware-options",[21],[167,168,169],"style",{},"html .default .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}html .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}html .dark .shiki span {color: var(--shiki-dark);background: var(--shiki-dark-bg);font-style: var(--shiki-dark-font-style);font-weight: var(--shiki-dark-font-weight);text-decoration: var(--shiki-dark-text-decoration);}html.dark .shiki span {color: var(--shiki-dark);background: var(--shiki-dark-bg);font-style: var(--shiki-dark-font-style);font-weight: var(--shiki-dark-font-weight);text-decoration: var(--shiki-dark-text-decoration);}",{"title":35,"searchDepth":49,"depth":49,"links":171},[172,173,174],{"id":28,"depth":49,"text":28},{"id":136,"depth":49,"text":137},{"id":158,"depth":49,"text":159},"md",{"createdAt":177,"url":178,"tags":179,"excerpt":182},"2020-11-11 17:13:12","setting-up-http-proxy-middleware",[180,181],"前端","筆記",{"type":8,"value":183},[184,186],[11,185,13],{},[11,187,188],{},[17,189,19],{"href":19,"rel":190},[21],"/http-proxy-middleware",{"title":6,"description":13},"設定 http-proxy-middleware","bRYec5bove-9FfeAwnN4CC3NCFldoKFM93tGMn-LUKo",1744039164536]